<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão MedSuCare</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #20637D; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #1a4f63; 
        }
        
        .brand-bg { background-color: #20637D; }
        .brand-text { color: #20637D; }
        .brand-border { border-color: #20637D; }
        
        .chat-bubble {
            max-width: 80%;
            word-wrap: break-word;
        }
        .chat-bubble.sent {
            background-color: #20637D;
            color: white;
            align-self: flex-end;
            border-radius: 15px 15px 0 15px;
        }
        .chat-bubble.received {
            background-color: #e5e7eb;
            color: black;
            align-self: flex-start;
            border-radius: 15px 15px 15px 0;
        }

        /* Print Styles for Labels */
        @media print {
            body * { visibility: hidden; }
            #print-area, #print-area * { visibility: visible; }
            #print-area { position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans h-screen flex flex-col overflow-hidden">

    <!-- Google API Loader -->
    <script>
        // Global State
        const CONFIG = {
            API_KEY: 'AIzaSyD-9tuxZ9qcVhSU8zKkT9XzY0rkf8jsVzY', // Public API Key
            CLIENT_ID: '1068094715814-1l921uhaue0h7k9bv0i4qhav9ima23fu.apps.googleusercontent.com',
            DISCOVERY_DOCS: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            SCOPES: 'https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive.readonly',
            SPREADSHEET_ID: '1IJHX7IDnHhxa3_TxBBBjQxlomhH594Q6HAgnoItCmwA',
            LOGO_URL: 'https://drive.google.com/uc?export=view&id=1V_lVXX9-MBvnMcK6AORy-dqbMbdBheFi'
        };

        let gapiInited = false;
        let gisInited = false;
        let currentUser = null;
        let currentView = 'login';
        let userRole = null;

        // Initialize GAPI
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            await gapi.client.init({
                apiKey: CONFIG.API_KEY,
                discoveryDocs: CONFIG.DISCOVERY_DOCS,
            });
            gapiInited = true;
            maybeEnableButtons();
        }

        function gisLoaded() {
            const tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CONFIG.CLIENT_ID,
                scope: CONFIG.SCOPES,
                callback: (tokenResponse) => {
                    if (tokenResponse.error) {
                        console.error(tokenResponse);
                        alert('Erro de autenticação: ' + tokenResponse.error);
                        return;
                    }
                    handleAuthResult(tokenResponse);
                },
            });
            gisInited = true;
            maybeEnableButtons();
            window.tokenClient = tokenClient;
        }

        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                document.getElementById('login-btn').disabled = false;
            }
        }

        async function handleAuthResult(tokenResponse) {
            const user = google.accounts.oauth2.initTokenClient.user;
            const email = user.w3.U3; // Extract email
            
            // Verify user in Sheets
            const userData = await fetchSheetData('Usuários');
            const validUser = userData.find(row => row[0] === email);

            if (validUser) {
                currentUser = { email, name: validUser[1], role: validUser[2] };
                userRole = validUser[2];
                showApp();
            } else {
                // Check if pending request exists
                const reqData = await fetchSheetData('Solicitações');
                const existingReq = reqData.find(row => row[0] === email);
                
                if (!existingReq) {
                    // Register request
                    await appendSheetData('Solicitações', [email, user.name || 'N/A', new Date().toLocaleString()]);
                    alert('Sua conta não tem permissão. Uma solicitação de acesso foi enviada ao administrador.');
                } else {
                    alert('Sua solicitação já foi registrada e está pendente de aprovação.');
                }
                google.accounts.oauth2.revoke(tokenResponse.access_token);
            }
        }

        // --- Sheets API Helpers ---
        async function fetchSheetData(sheetName) {
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: CONFIG.SPREADSHEET_ID,
                    range: sheetName,
                });
                return response.result.values || [];
            } catch (err) {
                console.error('Error fetching data:', err);
                return [];
            }
        }

        async function appendSheetData(sheetName, rowData) {
            try {
                await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: CONFIG.SPREADSHEET_ID,
                    range: sheetName,
                    valueInputOption: 'USER_ENTERED',
                    resource: { values: [rowData] }
                });
            } catch (err) {
                console.error('Error appending data:', err);
            }
        }

        async function updateSheetData(sheetName, rowIndex, columnIndex, value) {
            const range = `${sheetName}!${String.fromCharCode(65 + columnIndex)}${rowIndex + 1}`;
            try {
                await gapi.client.sheets.spreadsheets.values.update({
                    spreadsheetId: CONFIG.SPREADSHEET_ID,
                    range: range,
                    valueInputOption: 'USER_ENTERED',
                    resource: { values: [[value]] }
                });
            } catch (err) {
                console.error('Error updating data:', err);
            }
        }

        // --- Lógica da Interface ---
        function showApp() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app-container').classList.remove('hidden');
            renderSidebar();
            navigateTo('dashboard');
        }

        function renderSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mobileMenu = document.getElementById('mobile-menu');
            let links = `
                <a href="#" onclick="navigateTo('dashboard')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-home w-6"></i> <span class="ml-2">Dashboard</span></a>
            `;
            let mobileLinks = `
                <a href="#" onclick="navigateTo('dashboard'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-home w-6"></i> <span class="ml-2">Dashboard</span></a>
            `;

            if (userRole === 'ADMIN' || userRole === 'VENDEDOR') {
                links += `<a href="#" onclick="navigateTo('clientes')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-users w-6"></i> <span class="ml-2">Clientes</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('clientes'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-users w-6"></i> <span class="ml-2">Clientes</span></a>`;
            }
            if (userRole === 'ADMIN' || userRole === 'COMPRADOR') {
                links += `<a href="#" onclick="navigateTo('fornecedores')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-truck w-6"></i> <span class="ml-2">Fornecedores</span></a>`;
                links += `<a href="#" onclick="navigateTo('estoque')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-boxes w-6"></i> <span class="ml-2">Estoque</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('fornecedores'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-truck w-6"></i> <span class="ml-2">Fornecedores</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('estoque'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-boxes w-6"></i> <span class="ml-2">Estoque</span></a>`;
            }
            if (userRole === 'ADMIN' || userRole === 'CHEFE DE PRODUÇÃO') {
                links += `<a href="#" onclick="navigateTo('os')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-clipboard-list w-6"></i> <span class="ml-2">Ordens de Serviço</span></a>`;
                links += `<a href="#" onclick="navigateTo('producao')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-industry w-6"></i> <span class="ml-2">Produção</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('os'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-clipboard-list w-6"></i> <span class="ml-2">Ordens de Serviço</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('producao'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-industry w-6"></i> <span class="ml-2">Produção</span></a>`;
            }
            if (userRole === 'ADMIN') {
                links += `<a href="#" onclick="navigateTo('usuarios')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-user-shield w-6"></i> <span class="ml-2">Usuários</span></a>`;
                links += `<a href="#" onclick="navigateTo('financeiro')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-file-invoice-dollar w-6"></i> <span class="ml-2">Financeiro</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('usuarios'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-user-shield w-6"></i> <span class="ml-2">Usuários</span></a>`;
                mobileLinks += `<a href="#" onclick="navigateTo('financeiro'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-file-invoice-dollar w-6"></i> <span class="ml-2">Financeiro</span></a>`;
            }
            
            links += `<a href="#" onclick="navigateTo('chat')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-comments w-6"></i> <span class="ml-2">Comunicação</span></a>`;
            links += `<a href="#" onclick="navigateTo('calculadora')" class="flex items-center p-3 hover:bg-blue-700 transition"><i class="fas fa-calculator w-6"></i> <span class="ml-2">Calculadora de Fardos</span></a>`;
            mobileLinks += `<a href="#" onclick="navigateTo('chat'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-comments w-6"></i> <span class="ml-2">Comunicação</span></a>`;
            mobileLinks += `<a href="#" onclick="navigateTo('calculadora'); document.getElementById('mobile-menu').classList.add('hidden')" class="flex items-center p-3 hover:bg-blue-700 transition border-b border-blue-800"><i class="fas fa-calculator w-6"></i> <span class="ml-2">Calculadora de Fardos</span></a>`;
            
            sidebar.innerHTML = `
                <div class="p-4 border-b border-blue-700 flex items-center justify-center">
                    <img src="${CONFIG.LOGO_URL}" alt="Logo MedSuCare" class="h-10 w-auto">
                </div>
                <div class="flex-1 overflow-y-auto py-2">
                    ${links}
                </div>
                <div class="p-4 border-t border-blue-700">
                    <div class="text-white text-sm mb-2">${currentUser.name}</div>
                    <div class="text-white text-xs opacity-75 mb-3">${userRole}</div>
                    <button onclick="logout()" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded text-sm transition">Sair</button>
                </div>
            `;
            
            // Atualizar o menu mobile
            mobileMenu.innerHTML = mobileLinks;
        }

        function navigateTo(view) {
            currentView = view;
            document.querySelectorAll('#sidebar a').forEach(el => el.classList.remove('bg-blue-700'));
            // Highlight active (simplified)
            
            // Hide all views
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            
            // Show target view
            const target = document.getElementById(`view-${view}`);
            if(target) target.classList.remove('hidden');
            
            // Load data based on view
            if(view === 'dashboard') loadDashboard();
            if(view === 'os') loadOS();
            if(view === 'chat') loadChat();
            if(view === 'usuarios') loadUsers();
            if(view === 'clientes') loadClientes();
            if(view === 'estoque') loadEstoque();
            if(view === 'calculadora') {
                // Reset calculator
                document.getElementById('calc-resultado').classList.add('hidden');
                // Set default values
                document.getElementById('calc-qtd-total').value = '1000';
                document.getElementById('calc-embalagem').value = 'unitario';
                document.getElementById('calc-tamanho').value = 'M';
                document.getElementById('calc-gramatura').value = '10';
            }
        }

        function logout() {
            google.accounts.oauth2.revoke(gapi.client.getToken().access_token);
            currentUser = null;
            document.getElementById('app-container').classList.add('hidden');
            document.getElementById('login-screen').classList.remove('hidden');
        }

        // --- Carregadores de Visualizações ---

        async function loadDashboard() {
            // Estatísticas simples
            const osData = await fetchSheetData('OS');
            const prodData = await fetchSheetData('Produção');
            const clientesData = await fetchSheetData('Clientes');
            
            document.getElementById('stat-os').innerText = osData.length;
            document.getElementById('stat-prod').innerText = prodData.length;
            document.getElementById('stat-clientes').innerText = clientesData.length;
            
            // Contar OS pendentes
            const osPendentes = osData.filter(row => row[4] === 'Pendente' || !row[4]);
            document.getElementById('stat-pendentes').innerText = osPendentes.length;
            
            // Carregar OS pendentes na tabela
            const tbody = document.getElementById('os-pendentes-body');
            tbody.innerHTML = '';
            const osPendentesExibir = osPendentes.slice(0, 5);
            
            osPendentesExibir.forEach(row => {
                tbody.innerHTML += `
                    <tr class="border-b hover:bg-gray-50">
                        <td class="p-2">${row[0] || ''}</td>
                        <td class="p-2">${row[1] || ''}</td>
                        <td class="p-2">${row[2] || ''}</td>
                        <td class="p-2">${row[3] || ''}</td>
                        <td class="p-2">
                            <span class="px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800">Pendente</span>
                        </td>
                    </tr>
                `;
            });
        }

        async function loadOS() {
            const data = await fetchSheetData('OS');
            const tbody = document.getElementById('os-table-body');
            tbody.innerHTML = '';
            data.forEach((row, index) => {
                // Colunas: ID, Cliente, Produto, Qtd, Status, Data
                const status = row[4] || 'Pendente';
                const statusClass = status === 'Concluído' ? 'bg-green-100 text-green-800' : 
                                  status === 'Em Produção' ? 'bg-blue-100 text-blue-800' : 
                                  status === 'Corte' ? 'bg-purple-100 text-purple-800' : 
                                  'bg-yellow-100 text-yellow-800';
                
                tbody.innerHTML += `
                    <tr class="border-b hover:bg-gray-50">
                        <td class="p-2 font-mono">${row[0] || ''}</td>
                        <td class="p-2">${row[1] || ''}</td>
                        <td class="p-2">${row[2] || ''}</td>
                        <td class="p-2 text-center">${row[3] || ''}</td>
                        <td class="p-2">
                            <span class="px-2 py-1 rounded text-xs ${statusClass}">${status}</span>
                        </td>
                        <td class="p-2">${row[5] || ''}</td>
                        <td class="p-2">
                            <div class="flex space-x-2">
                                <button onclick="printLabel('${row[0]}')" class="text-blue-600 hover:text-blue-800" title="Imprimir Etiqueta"><i class="fas fa-print"></i></button>
                                <button onclick="updateOSStatus('${row[0]}', 'Corte')" class="text-purple-600 hover:text-purple-800" title="Enviar para Corte"><i class="fas fa-cut"></i></button>
                                <button onclick="updateOSStatus('${row[0]}', 'Em Produção')" class="text-blue-600 hover:text-blue-800" title="Enviar para Produção"><i class="fas fa-industry"></i></button>
                                <button onclick="updateOSStatus('${row[0]}', 'Concluído')" class="text-green-600 hover:text-green-800" title="Marcar como Concluído"><i class="fas fa-check"></i></button>
                            </div>
                        </td>
                    </tr>
                `;
            });
        }

        async function loadChat() {
            // Chat simulado para protótipo
            const chatBox = document.getElementById('chat-messages');
            const hoje = new Date().toLocaleDateString('pt-BR');
            chatBox.innerHTML = `
                <div class="chat-bubble received p-3 mb-2">
                    <div class="text-xs text-gray-500">Sistema - ${hoje}</div>
                    Bem-vindo ao sistema de comunicação interna da MedSuCare. Você está logado como <strong>${currentUser.name}</strong> (${userRole}).
                </div>
                <div class="chat-bubble received p-3 mb-2">
                    <div class="text-xs text-gray-500">Administrador - ${hoje}</div>
                    Lembrem-se: Todas as OS devem ser registradas no sistema para controle de produção.
                </div>
                <div class="chat-bubble received p-3 mb-2">
                    <div class="text-xs text-gray-500">Chefe de Produção - ${hoje}</div>
                    OS com status "Corte" devem ser processadas em até 24 horas. Favor manter o cronograma.
                </div>
                <div class="chat-bubble received p-3 mb-2">
                    <div class="text-xs text-gray-500">Comprador - ${hoje}</div>
                    Novo lote de TNT chega amanhã às 10h. Favor preparar área de recebimento.
                </div>
                <div class="chat-bubble received p-3 mb-2">
                    <div class="text-xs text-gray-500">Vendedor - ${hoje}</div>
                    Novo cliente hospitalar cadastrado: Hospital São Lucas. OS será criada em breve.
                </div>
            `;
            // Scroll to bottom
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        async function loadUsers() {
            const data = await fetchSheetData('Usuários');
            const tbody = document.getElementById('users-table-body');
            tbody.innerHTML = '';
            data.forEach(row => {
                tbody.innerHTML += `
                    <tr class="border-b">
                        <td class="p-2">${row[0]}</td>
                        <td class="p-2">${row[1]}</td>
                        <td class="p-2">${row[2]}</td>
                    </tr>
                `;
            });
        }

        async function loadClientes() {
            const data = await fetchSheetData('Clientes');
            const tbody = document.getElementById('clientes-table-body');
            tbody.innerHTML = '';
            data.forEach(row => {
                tbody.innerHTML += `
                    <tr class="border-b">
                        <td class="p-2">${row[0] || ''}</td>
                        <td class="p-2">${row[1] || ''}</td>
                        <td class="p-2">${row[2] || ''}</td>
                    </tr>
                `;
            });
        }

        async function loadEstoque() {
            const data = await fetchSheetData('Estoque');
            const tbody = document.getElementById('estoque-table-body');
            tbody.innerHTML = '';
            data.forEach(row => {
                tbody.innerHTML += `
                    <tr class="border-b">
                        <td class="p-2">${row[0] || ''}</td>
                        <td class="p-2">${row[1] || ''}</td>
                        <td class="p-2">${row[2] || ''}</td>
                    </tr>
                `;
            });
        }

        // --- Ações ---

        function createOS() {
            const now = new Date();
            const osId = `${String(now.getDate()).padStart(2,'0')}${String(now.getMonth()+1).padStart(2,'0')}${String(now.getFullYear()).slice(-2)}${String(now.getHours()).padStart(2,'0')}${String(now.getMinutes()).padStart(2,'0')}`;
            
            const cliente = document.getElementById('os-cliente').value;
            const produto = document.getElementById('os-produto').value;
            const qtd = document.getElementById('os-qtd').value;
            const composicao = document.getElementById('os-composicao').value;
            const tamanho = document.getElementById('os-tamanho').value;
            const esterelidade = document.getElementById('os-esterelidade').value;
            const embalagem = document.getElementById('os-embalagem').value;

            appendSheetData('OS', [osId, cliente, produto, qtd, 'Pendente', new Date().toLocaleString(), composicao, tamanho, esterelidade, embalagem]);
            alert(`Ordem de Serviço ${osId} criada com sucesso!`);
            loadOS();
        }

        async function updateOSStatus(osId, newStatus) {
            const data = await fetchSheetData('OS');
            const rowIndex = data.findIndex(row => row[0] === osId);
            
            if (rowIndex !== -1) {
                await updateSheetData('OS', rowIndex + 1, 4, newStatus);
                alert(`OS ${osId} atualizada para: ${newStatus}`);
                loadOS();
            }
        }

        function printLabel(osId) {
            const printArea = document.getElementById('print-area');
            printArea.innerHTML = '';
            
            // Perguntar qual tipo de etiqueta imprimir
            const tipoEtiqueta = prompt('Qual tipo de etiqueta deseja imprimir?\n1. Para pacotes unitários (12 por folha)\n2. Para fardos/caixas (4 por folha)');
            
            if (tipoEtiqueta === '2') {
                // Etiquetas para fardos/caixas (4 por folha A4)
                for(let i=0; i<4; i++) {
                    const label = document.createElement('div');
                    label.className = 'label-fardo';
                    label.innerHTML = `
                        <div class="label-content-fardo">
                            <div class="label-header-fardo">
                                <img src="${CONFIG.LOGO_URL}" class="label-logo-fardo">
                                <span class="label-title-fardo">FARDO DE AVENTAIS HOSPITALARES</span>
                            </div>
                            <div class="label-body-fardo">
                                <div><strong>OS:</strong> ${osId}</div>
                                <div><strong>Conteúdo:</strong> Aventais Hospitalares</div>
                                <div><strong>Quantidade:</strong> 1 Fardo</div>
                                <div><strong>Peso Aprox.:</strong> 15-20 kg</div>
                                <div><strong>Dimensões:</strong> 40x60x80 cm</div>
                                <div><strong>Lote:</strong> ${new Date().getFullYear()}</div>
                            </div>
                            <div class="label-footer-fardo">MedSuCare EPI - Transportar com cuidado</div>
                        </div>
                    `;
                    printArea.appendChild(label);
                }
            } else {
                // Etiquetas para pacotes unitários (12 por folha A4)
                for(let i=0; i<12; i++) {
                    const label = document.createElement('div');
                    label.className = 'label-unit';
                    label.innerHTML = `
                        <div class="label-content">
                            <div class="label-header">
                                <img src="${CONFIG.LOGO_URL}" class="label-logo">
                                <span class="label-title">AVENTAL HOSPITALAR</span>
                            </div>
                            <div class="label-body">
                                <div>OS: ${osId}</div>
                                <div>Qtd: UN</div>
                                <div>Lote: ${new Date().getFullYear()}</div>
                            </div>
                            <div class="label-footer">MedSuCare EPI</div>
                        </div>
                    `;
                    printArea.appendChild(label);
                }
            }
            
            window.print();
        }

        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const msg = input.value;
            if(!msg) return;

            const chatBox = document.getElementById('chat-messages');
            chatBox.innerHTML += `
                <div class="chat-bubble sent p-3 mb-2">
                    <div class="text-xs text-right opacity-70">${currentUser.name}</div>
                    ${msg}
                </div>
            `;
            input.value = '';
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // --- Calculadora de Fardos ---
        function calcularFardos() {
            const qtdTotal = parseInt(document.getElementById('calc-qtd-total').value) || 0;
            const embalagem = document.getElementById('calc-embalagem').value;
            const tamanho = document.getElementById('calc-tamanho').value;
            const gramatura = parseInt(document.getElementById('calc-gramatura').value) || 10;
            
            // Definir unidades por fardo baseado no tipo de embalagem
            let unidadesPorFardo = 1;
            switch(embalagem) {
                case 'unitario': unidadesPorFardo = 1; break;
                case 'pacote5': unidadesPorFardo = 5; break;
                case 'pacote10': unidadesPorFardo = 10; break;
                case 'grau-cirurgico': unidadesPorFardo = 20; break; // Pacote cirúrgico geralmente tem mais unidades
            }
            
            // Calcular total de fardos
            const totalFardos = Math.ceil(qtdTotal / unidadesPorFardo);
            
            // Calcular peso aproximado baseado no tamanho e gramatura
            let areaPorAvental = 0;
            switch(tamanho) {
                case 'P': areaPorAvental = 1.0; break; // 1.0 m²
                case 'M': areaPorAvental = 1.2; break; // 1.2 m²
                case 'G': areaPorAvental = 1.4; break; // 1.4 m²
                case 'GG': areaPorAvental = 1.6; break; // 1.6 m²
                default: areaPorAvental = 1.2; break;
            }
            
            // Peso por avental em gramas
            const pesoPorAventalGramas = areaPorAvental * gramatura;
            
            // Peso por fardo em kg
            const pesoPorFardoKg = (pesoPorAventalGramas * unidadesPorFardo) / 1000;
            
            // Peso total em kg
            const pesoTotalKg = (pesoPorAventalGramas * qtdTotal) / 1000;
            
            // Volume aproximado por fardo (em m³)
            const volumePorFardo = 0.02; // Aproximadamente 20 litros por fardo
            
            // Capacidade de caminhão pequeno (3m³)
            const capacidadeCaminhao = Math.floor(3 / volumePorFardo);
            
            // Atualizar resultados
            document.getElementById('result-qtd-total').textContent = qtdTotal.toLocaleString('pt-BR');
            document.getElementById('result-unidades-fardo').textContent = unidadesPorFardo;
            document.getElementById('result-total-fardos').textContent = totalFardos.toLocaleString('pt-BR');
            document.getElementById('result-peso-fardo').textContent = pesoPorFardoKg.toFixed(2) + ' kg';
            document.getElementById('result-peso-total').textContent = pesoTotalKg.toFixed(2) + ' kg';
            document.getElementById('result-volume-fardo').textContent = volumePorFardo.toFixed(3);
            document.getElementById('result-capacidade-caminhao').textContent = capacidadeCaminhao;
            
            // Mostrar resultados
            document.getElementById('calc-resultado').classList.remove('hidden');
        }

    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>

    <!-- Tela de Login -->
    <div id="login-screen" class="flex-1 flex items-center justify-center bg-gray-50 p-4">
        <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md text-center">
            <img src="https://drive.google.com/uc?export=view&id=1V_lVXX9-MBvnMcK6AORy-dqbMbdBheFi" alt="Logo MedSuCare" class="h-24 mx-auto mb-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-2">Gestão MedSuCare</h1>
            <p class="text-gray-600 mb-8">Sistema Integrado de Gestão de Produção de EPIs Hospitalares</p>
            
            <button id="login-btn" disabled onclick="window.tokenClient.requestAccessToken()" class="w-full bg-[#20637D] hover:bg-[#1a4f63] text-white font-bold py-3 px-4 rounded-lg transition flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fab fa-google mr-2"></i> Entrar com Google
            </button>
            <p class="text-xs text-gray-400 mt-4">Acesso restrito a colaboradores autorizados da MedSuCare.</p>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="hidden flex-1 flex h-full">
        <!-- Sidebar -->
        <aside id="sidebar" class="w-64 bg-[#20637D] flex flex-col hidden md:flex">
            <!-- Content rendered by JS -->
        </aside>

        <!-- Mobile Header -->
        <div class="md:hidden bg-[#20637D] text-white p-4 flex justify-between items-center no-print">
            <div class="flex items-center">
                <img src="https://drive.google.com/uc?export=view&id=1V_lVXX9-MBvnMcK6AORy-dqbMbdBheFi" class="h-8 mr-2">
                <span class="font-bold">MedSuCare</span>
            </div>
            <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-white">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-[#20637D] text-white absolute w-full z-50 no-print">
            <div class="p-4 border-b border-blue-800 flex justify-between items-center">
                <div class="flex items-center">
                    <img src="https://drive.google.com/uc?export=view&id=1V_lVXX9-MBvnMcK6AORy-dqbMbdBheFi" class="h-8 mr-2">
                    <span class="font-bold">MedSuCare</span>
                </div>
                <button onclick="document.getElementById('mobile-menu').classList.add('hidden')" class="text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
             <!-- Mobile links injected by JS -->
        </div>

        <!-- Content Area -->
        <main class="flex-1 flex flex-col h-full overflow-hidden bg-gray-100">
            
            <!-- Dashboard View -->
            <div id="view-dashboard" class="view-section flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-gray-500 text-sm">Ordens de Serviço</div>
                        <div class="text-3xl font-bold text-[#20637D]" id="stat-os">0</div>
                        <div class="text-sm text-gray-400 mt-1">Total de OS</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-gray-500 text-sm">Produção Ativa</div>
                        <div class="text-3xl font-bold text-[#20637D]" id="stat-prod">0</div>
                        <div class="text-sm text-gray-400 mt-1">Em andamento</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-gray-500 text-sm">Clientes Ativos</div>
                        <div class="text-3xl font-bold text-[#20637D]" id="stat-clientes">0</div>
                        <div class="text-sm text-gray-400 mt-1">Cadastrados</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-gray-500 text-sm">OS Pendentes</div>
                        <div class="text-3xl font-bold text-[#20637D]" id="stat-pendentes">0</div>
                        <div class="text-sm text-gray-400 mt-1">Aguardando processamento</div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="font-bold text-lg mb-4">OS Pendentes</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-2 text-left">ID OS</th>
                                        <th class="p-2 text-left">Cliente</th>
                                        <th class="p-2 text-left">Produto</th>
                                        <th class="p-2 text-left">Qtd</th>
                                        <th class="p-2 text-left">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="os-pendentes-body">
                                    <!-- Linhas carregadas por JS -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-4 text-center">
                            <button onclick="navigateTo('os')" class="text-[#20637D] hover:text-[#1a4f63] text-sm font-medium">Ver todas as OS →</button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="font-bold text-lg mb-4">Ações Rápidas</h3>
                        <div class="space-y-3">
                            <button onclick="document.getElementById('modal-new-os').classList.remove('hidden')" class="w-full bg-[#20637D] text-white px-4 py-3 rounded hover:bg-[#1a4f63] flex items-center justify-center">
                                <i class="fas fa-plus mr-2"></i> Nova Ordem de Serviço
                            </button>
                            <button onclick="navigateTo('clientes')" class="w-full bg-white border border-gray-300 text-gray-700 px-4 py-3 rounded hover:bg-gray-50 flex items-center justify-center">
                                <i class="fas fa-user-plus mr-2"></i> Cadastrar Cliente
                            </button>
                            <button onclick="navigateTo('estoque')" class="w-full bg-white border border-gray-300 text-gray-700 px-4 py-3 rounded hover:bg-gray-50 flex items-center justify-center">
                                <i class="fas fa-boxes mr-2"></i> Verificar Estoque
                            </button>
                            <button onclick="navigateTo('calculadora')" class="w-full bg-white border border-gray-300 text-gray-700 px-4 py-3 rounded hover:bg-gray-50 flex items-center justify-center">
                                <i class="fas fa-calculator mr-2"></i> Calcular Fardos
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- OS View -->
            <div id="view-os" class="view-section hidden flex-1 overflow-y-auto p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Ordens de Serviço</h2>
                    <button onclick="document.getElementById('modal-new-os').classList.remove('hidden')" class="bg-[#20637D] text-white px-4 py-2 rounded hover:bg-[#1a4f63] flex items-center">
                        <i class="fas fa-plus mr-2"></i> Nova OS
                    </button>
                </div>

                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="p-4">ID OS</th>
                                    <th class="p-4">Cliente</th>
                                    <th class="p-4">Produto</th>
                                    <th class="p-4">Qtd</th>
                                    <th class="p-4">Status</th>
                                    <th class="p-4">Data</th>
                                    <th class="p-4">Ações</th>
                                </tr>
                            </thead>
                            <tbody id="os-table-body">
                                <!-- Linhas injetadas por JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Chat View -->
            <div id="view-chat" class="view-section hidden flex-1 flex flex-col h-full bg-white">
                <div class="p-4 border-b bg-[#20637D] text-white font-bold flex justify-between items-center">
                    <span>Comunicação Interna</span>
                    <span class="text-sm font-normal">Equipe MedSuCare</span>
                </div>
                <div id="chat-messages" class="flex-1 overflow-y-auto p-4 bg-gray-50 flex flex-col">
                    <!-- Mensagens injetadas por JS -->
                </div>
                <div class="p-4 border-t bg-white flex">
                    <input type="text" id="chat-input" placeholder="Digite sua mensagem para a equipe..." class="flex-1 border rounded-l-lg px-4 py-2 focus:outline-none focus:border-[#20637D]" onkeypress="if(event.key==='Enter') sendChatMessage()">
                    <button onclick="sendChatMessage()" class="bg-[#20637D] text-white px-4 py-2 rounded-r-lg hover:bg-[#1a4f63]">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <!-- Users View (Admin) -->
            <div id="view-usuarios" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Gerenciamento de Usuários</h2>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="p-4">E-mail</th>
                                <th class="p-4">Nome</th>
                                <th class="p-4">Função</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body">
                            <!-- Rows injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Clientes View -->
            <div id="view-clientes" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Clientes</h2>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="p-4">Nome</th>
                                <th class="p-4">CNPJ</th>
                                <th class="p-4">Contato</th>
                            </tr>
                        </thead>
                        <tbody id="clientes-table-body">
                            <!-- Rows injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Estoque View -->
            <div id="view-estoque" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Estoque</h2>
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="p-4">Item</th>
                                <th class="p-4">Tipo</th>
                                <th class="p-4">Quantidade</th>
                            </tr>
                        </thead>
                        <tbody id="estoque-table-body">
                            <!-- Rows injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Placeholder Views -->
            <div id="view-fornecedores" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Fornecedores</h2>
                <p class="text-gray-500">Módulo em desenvolvimento.</p>
            </div>
            <div id="view-producao" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Produção</h2>
                <p class="text-gray-500">Módulo em desenvolvimento.</p>
            </div>
            <div id="view-financeiro" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Financeiro</h2>
                <p class="text-gray-500">Módulo em desenvolvimento.</p>
            </div>

            <!-- Calculadora de Fardos -->
            <div id="view-calculadora" class="view-section hidden flex-1 overflow-y-auto p-6">
                <h2 class="text-2xl font-bold mb-6">Calculadora de Fardos</h2>
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h3 class="font-bold text-lg mb-4">Calcular Quantidade de Fardos</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Quantidade Total de Aventais</label>
                            <input type="number" id="calc-qtd-total" class="w-full border rounded px-3 py-2" placeholder="Ex: 1000" value="1000">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Embalagem</label>
                            <select id="calc-embalagem" class="w-full border rounded px-3 py-2">
                                <option value="unitario">Unitário</option>
                                <option value="pacote5">Pacote com 5 unidades</option>
                                <option value="pacote10">Pacote com 10 unidades</option>
                                <option value="grau-cirurgico">Grau cirúrgico</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tamanho do Avental</label>
                            <select id="calc-tamanho" class="w-full border rounded px-3 py-2">
                                <option value="P">P (Pequeno)</option>
                                <option value="M">M (Médio)</option>
                                <option value="G">G (Grande)</option>
                                <option value="GG">GG (Extra Grande)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Gramatura (g/m²)</label>
                            <select id="calc-gramatura" class="w-full border rounded px-3 py-2">
                                <option value="10">10 g/m²</option>
                                <option value="20">20 g/m²</option>
                                <option value="30">30 g/m²</option>
                                <option value="40">40 g/m²</option>
                                <option value="55">55 g/m²</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="calcularFardos()" class="mt-6 bg-[#20637D] text-white px-6 py-3 rounded hover:bg-[#1a4f63] w-full md:w-auto">
                        Calcular Fardos
                    </button>
                </div>
                
                <div id="calc-resultado" class="bg-white rounded-lg shadow p-6 hidden">
                    <h3 class="font-bold text-lg mb-4">Resultado do Cálculo</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Quantidade Total:</span>
                            <span class="font-bold" id="result-qtd-total">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Unidades por Fardo:</span>
                            <span class="font-bold" id="result-unidades-fardo">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total de Fardos:</span>
                            <span class="font-bold text-[#20637D]" id="result-total-fardos">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Peso Aproximado por Fardo:</span>
                            <span class="font-bold" id="result-peso-fardo">0 kg</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Peso Total Estimado:</span>
                            <span class="font-bold" id="result-peso-total">0 kg</span>
                        </div>
                        <div class="mt-4 p-3 bg-blue-50 rounded border border-blue-200">
                            <p class="text-sm text-blue-700">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Recomendação:</strong> Para transporte, considere que cada fardo ocupa aproximadamente <span id="result-volume-fardo">0.02</span> m³. 
                                Um caminhão pequeno (3m³) comporta cerca de <span id="result-capacidade-caminhao">150</span> fardos.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Modais -->
    <div id="modal-new-os" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-4">Criar Nova Ordem de Serviço</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Cliente *</label>
                    <input type="text" id="os-cliente" class="w-full border rounded px-3 py-2 mt-1" placeholder="Nome do cliente ou digite livremente" required>
                    <p class="text-xs text-gray-500 mt-1">Digite o nome do cliente ou selecione da lista existente</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Produto *</label>
                    <select id="os-produto" class="w-full border rounded px-3 py-2 mt-1" required>
                        <option value="">Selecione um produto</option>
                        <option value="Avental Hospitalar">Avental Hospitalar</option>
                        <option value="Capote">Capote</option>
                        <option value="Avental Cirúrgico">Avental Cirúrgico</option>
                        <option value="Avental Procedimentos">Avental para Procedimentos</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Quantidade *</label>
                    <input type="number" id="os-qtd" class="w-full border rounded px-3 py-2 mt-1" placeholder="Quantidade" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Composição</label>
                    <select id="os-composicao" class="w-full border rounded px-3 py-2 mt-1">
                        <option value="TNT">TNT (Tecido Não Tecido)</option>
                        <option value="100% Polipropileno">100% Polipropileno</option>
                        <option value="SMMS">SMMS</option>
                        <option value="SSMMSS">SSMMSS</option>
                        <option value="SMS">SMS</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Tamanho</label>
                    <select id="os-tamanho" class="w-full border rounded px-3 py-2 mt-1">
                        <option value="P">P (Pequeno)</option>
                        <option value="M">M (Médio)</option>
                        <option value="G">G (Grande)</option>
                        <option value="GG">GG (Extra Grande)</option>
                        <option value="XG">XG (Extra Grande)</option>
                        <option value="ÚNICO">ÚNICO</option>
                        <option value="1,00 x 1,40m">1,00 x 1,40m</option>
                        <option value="1,20 x 1,40m">1,20 x 1,40m</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Esterelidade</label>
                    <select id="os-esterelidade" class="w-full border rounded px-3 py-2 mt-1">
                        <option value="Não estéril">Não estéril</option>
                        <option value="Estéril">Estéril</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Embalagem</label>
                    <select id="os-embalagem" class="w-full border rounded px-3 py-2 mt-1">
                        <option value="Unitário">Unitário</option>
                        <option value="Pacote com 5 unidades">Pacote com 5 unidades</option>
                        <option value="Pacote com 10 unidades">Pacote com 10 unidades</option>
                        <option value="Grau cirúrgico">Grau cirúrgico</option>
                    </select>
                </div>
            </div>
            <div class="mt-6 flex justify-end gap-2">
                <button onclick="document.getElementById('modal-new-os').classList.add('hidden')" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancelar</button>
                <button onclick="createOS(); document.getElementById('modal-new-os').classList.add('hidden')" class="px-4 py-2 bg-[#20637D] text-white rounded hover:bg-[#1a4f63]">Criar OS</button>
            </div>
        </div>
    </div>

    <!-- Print Area (Hidden) -->
    <div id="print-area" class="hidden">
        <!-- Labels generated by JS -->
    </div>

    <style>
        @media print {
            body * { visibility: hidden; }
            #print-area, #print-area * { visibility: visible; }
            #print-area { 
                position: absolute; 
                left: 0; 
                top: 0; 
                width: 100%;
                display: block !important;
            }
            .no-print { display: none !important; }
        }
        
        /* Label Styles for A4 Landscape */
        @page { size: A4 landscape; margin: 0; }
        
        .label-unit {
            width: 105mm;
            height: 49.5mm;
            display: inline-block;
            margin: 0;
            padding: 2mm;
            box-sizing: border-box;
            border: 1px dashed #ccc; /* Guide line */
            overflow: hidden;
            page-break-inside: avoid;
            position: relative;
            background: white;
        }
        
        .label-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-family: Arial, sans-serif;
            font-size: 10px;
        }
        
        .label-header {
            display: flex;
            align-items: center;
            border-bottom: 1px solid #20637D;
            padding-bottom: 1mm;
        }
        
        .label-logo {
            height: 8mm;
            width: auto;
            margin-right: 2mm;
        }
        
        .label-title {
            font-weight: bold;
            color: #20637D;
            font-size: 11px;
        }
        
        .label-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            line-height: 1.4;
        }
        
        .label-footer {
            text-align: center;
            font-size: 8px;
            color: #666;
            border-top: 1px solid #eee;
            padding-top: 1mm;
        }
        
        /* Estilos para etiquetas de fardos (4 por folha A4) */
        .label-fardo {
            width: 105mm;
            height: 148.5mm;
            display: inline-block;
            margin: 0;
            padding: 5mm;
            box-sizing: border-box;
            border: 1px dashed #ccc;
            overflow: hidden;
            page-break-inside: avoid;
            position: relative;
            background: white;
        }
        
        .label-content-fardo {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-family: Arial, sans-serif;
            font-size: 12px;
        }
        
        .label-header-fardo {
            display: flex;
            flex-direction: column;
            align-items: center;
            border-bottom: 2px solid #20637D;
            padding-bottom: 3mm;
            margin-bottom: 5mm;
        }
        
        .label-logo-fardo {
            height: 15mm;
            width: auto;
            margin-bottom: 2mm;
        }
        
        .label-title-fardo {
            font-weight: bold;
            color: #20637D;
            font-size: 16px;
            text-align: center;
        }
        
        .label-body-fardo {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            line-height: 1.8;
            padding: 0 5mm;
        }
        
        .label-body-fardo div {
            margin-bottom: 2mm;
        }
        
        .label-footer-fardo {
            text-align: center;
            font-size: 10px;
            color: #FF0000;
            border-top: 1px solid #eee;
            padding-top: 3mm;
            font-weight: bold;
        }
    </style>
</body>
</html>
